<!DOCTYPE html>
<html>

<head>
    <!--<link rel="stylesheet" href="node_modules/bulma/css/bulma.css">-->
    <link rel="stylesheet" href="node_modules/font-awesome/css/font-awesome.css">
    <link rel="stylesheet" href="style.css">
    <script src="node_modules/vue/dist/vue.js"></script>
    <script src="data.js"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>imageinary</title>
</head>

<body class="has-text-centered">
    <div id="app">
        <div class="modal" :style="show ? 'display:block' : ''">
            <div class="modal-background" @click="show=false"></div>
            <div class="columns">
                <div class="column is-8-desktop is-offset-2-desktop is-12-tablet is-12-mobile image ">
                    <img :src="currImg" alt="">
                    <div class="tag is-success is-large ">
                    <h4 class="title is-4 has-text-white">{{i+1}}/{{files.length}}</h4>
                    </div>
                </div>
            </div>
            <button class="modal-close is-large" aria-label="close" @click="show= false"></button>
            <button class="modal-button-right button is-primary is-large" @click="i++"><i class="fa fa-arrow-right"></i></button>
            <button class="modal-button-left button is-primary is-large" @click="i--"><i class="fa fa-arrow-left"></i></button>
        </div>
        <div class="hero is-primary is-bold">
            <div class="hero-body">
                <h1 class="title is-1">{{folder}}</h1>
		<!--<h2 class="subtitle is-2">imageinary</h2>-->
                <hr>
                <button class="button is-info is-outlined is-large" @click="download">Download all images</button>
                <button @click="dltoggle = !dltoggle" :class="['button is-large',dltoggle ? 'is-success': 'is-warning']"><i class="fa fa-download"></i>&nbsp;{{dltoggle ? 'On':'Off'}}</button>
            </div>
        </div>
        <div class="hero is-bold is-info">
            <div class="hero-body">
                <div class="columns is-multiline is-mobile is-centered">
                    <image-card @modalimg="modalimg" class="column is-2-desktop is-3-tablet is-6-mobile" v-for="(file, key) in files" key="key"
                        :source="file" :index="key" :dltoggle="dltoggle"></image-card>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    Vue.component('image-card', {
        props: ['source', 'dltoggle', 'index'],
        template: `
        <div class='card'>
            <div class='card-image' @click="modaltoggle(source)">
                <!--<a :href="source" target="_blank" :download="dltoggle">-->
                    <figure class='image is-4by3'>
                        <img :src=thumb(source)>
                    </figure>
                </a>
            </div>
        </div>`,
        methods: {
            thumb: function (src) {
                return `.thumbnails/${src}`
            },
            modaltoggle: function (src) {
                //this.$emit('modalimg', src);
                this.$emit('modalimg', this.index)
            }
        }
    })

    var app = new Vue({
        el: '#app',
        data: {
            files: files,
            folder: folder,
            dltoggle: false,
            i: {
                get: function(){
                    return this.i
                },
                set: function(val){
                    if(val >= 0 && val <= files.length)
                        this.i = val;
                }
            },
            show: false
        },
        computed: {
            currImg: function () {
                return this.files[this.i]
            }
        },
        methods: {
            download: function () {
                this.dltoggle = true;
                document.querySelectorAll('a').forEach((e) => {
                    e.click();
                })
                this.dltoggle = false;
            },
            modalimg: function (val) {
                this.i = val;
                this.show = true
            }
        }
    })
</script>

</html>
